-- Fix: Create active theme for test restaurant
-- The test restaurant has ID=2 (from 079_add_test_restaurant.sql)
-- This migration explicitly creates a theme for that restaurant

INSERT INTO themes_v2 (
  tenant_id, restaurant_id, name, slug, config, description,
  is_active, is_published, version, created_by, created_at, updated_at
)
VALUES (
  1,
  2,  -- Restaurant ID from the test restaurant created in 079_add_test_restaurant.sql
  'Default Theme',
  'default-theme',
  '{
    "identity": {
      "siteTitle": "Test Restaurant",
      "logoUrl": "",
      "faviconUrl": "",
      "domain": "restaurant-1.localhost:3000"
    },
    "colors": {
      "primary": "#3b82f6",
      "secondary": "#1e40af",
      "accent": "#0ea5e9",
      "background": "#ffffff",
      "text": "#1f2937",
      "border": "#e5e7eb",
      "shadow": "#000000"
    },
    "typography": {
      "fontSans": "Inter, Arial, sans-serif",
      "fontSerif": "Georgia, serif",
      "fontMono": "Courier, monospace",
      "baseSize": 16,
      "lineHeight": 1.5,
      "borderRadius": 8
    },
    "header": {
      "logoUrl": "",
      "navBg": "#ffffff",
      "navText": "#1f2937",
      "navHeight": 80,
      "sticky": true
    },
    "footer": {
      "text": "Â© 2025 Test Restaurant. All rights reserved.",
      "bgColor": "#1f2937",
      "textColor": "#f3f4f6",
      "links": []
    },
    "components": [
      {
        "id": "hero-section",
        "type": "hero",
        "title": "Hero Section",
        "enabled": true,
        "displayOrder": 1,
        "config": {
          "title": "Welcome to Our Restaurant",
          "subtitle": "Experience authentic cuisine",
          "backgroundImage": "",
          "ctaText": "View Menu"
        }
      },
      {
        "id": "products-section",
        "type": "products",
        "title": "Featured Dishes",
        "enabled": true,
        "displayOrder": 2,
        "config": {
          "title": "Our Specialties",
          "itemsPerRow": 3
        }
      }
    ],
    "homepage": {
      "sections": []
    },
    "darkMode": {
      "enabled": false,
      "primaryDark": "#1e40af",
      "secondaryDark": "#1e3a8a",
      "backgroundDark": "#111827",
      "textDark": "#f3f4f6"
    },
    "rtl": {
      "enabled": false
    },
    "custom": {}
  }'::jsonb,
  'Default theme for restaurant',
  true,  -- is_active
  true,  -- is_published
  1,
  1,
  CURRENT_TIMESTAMP,
  CURRENT_TIMESTAMP
)
ON CONFLICT DO NOTHING;
